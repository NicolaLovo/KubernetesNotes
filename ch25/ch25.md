# Chapter 25 - Service Account

Types of users in kubernetes:

- human users
- serice accounts -> used by applications, bots, automations
  - use cases: Jenkins CI/CD pipelines, prometheus, programmatic interactions with the cluster

Roles are assigned to service accounts

By default there is a default service account for each namespace named `default`

- must be used with caution
- has some specific restrictions

Commands:

- `kubectl get sa -A`
- `kubectl get sa NAME -o yaml`

Creating a service account:

- `kubectl sa MY_SA`
- then assign roles to the SA with a role+roleBinding

Creating a long lived api token for a SA: [secret.yaml](./secret.yaml)

- once created, it will be populated with a secret token -> can be used in api calls...

> [!NOTE]
> ImagePullSecrets are used to pull images from private docker registries.
> ImagePullSecrets can be added to pods/deployments but also to service accounts -> allow a SA to pull images from a private registry

Use a service account:

- `kubect get pods --as MY_SA`
- REST api calls can be made with the token generated

## Default service account

`kubectl describe pods/MYPOD`

- in the field ServiceAccount, there is the "default" service account
- it mounts as a volume the secret of the default SA -> best practice to access a secret from inside a pod. I contains 3 files:
  - `token`
  - `namespace`
  - `ca.crt`
