# Chapter 23 - RBAC

- `kubectl auth whoami` -> show who I am in the cluster
- `kubectl auth can-i get pod` -> show if I can perform an operation
  - `kubectl auth can-i get pod --as USERNAME` -> check if user can do an operation
  - `kubectl auth can-i get deploy`

Defining a role:

- apiGroup -> "" for core group
- resources -> resources the role can access
- verbs -> verbs that can be used with the resources

> [NOTE]
> apiGroup: 2 groups -> core or namedGroup
> for core groups, we specify in apiVersion just v1
> for namedGroups we specify for example rbac.authorization.k8s.io/v1

`kubectl get role` -> show all roles in current namespace
`kubectl get roles -A --no-headers` -> get all roles, do not show the header of the table
`kubectl describe role MYROLE`
`kubectl create role NAME --verb=VERB1 --verb=VERB2 --resource=RESOURCE`

Apply a role to a user: roleBinding

`kubectl get rolebinding`

Log in with a user: 

- `kubectl config set-credentials adam --client-key=adam.key --client-certificate=adam.crt`
- `kubectl config set-context adam-ctx --cluster=MY_CLUSTER --user adam --embed-certs=true` -> creates a new context with name "adam-ctx"
- `kubectl config use-context adam-ctx`

Perform an actions as a user: `kubect get pod --as USERNAME`

